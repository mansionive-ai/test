<!doctype html>

<html lang="ko">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>이야기 페이지</title>
<style>
  html, body {
    height: 100%;
    margin: 0;
    font-family: system-ui, -apple-system, Roboto, 'Noto Sans KR', sans-serif;
    background: linear-gradient(120deg,#0f172a,#0b1220);
    color: #fff;
  }
  .wrap {
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-direction: column;
    text-align: center;
    padding: 2rem;
  }
  .card {
    background: none;
    backdrop-filter: none;
    padding: 0;
    box-shadow: none;
  }
  audio { display: none; }

#backBtn {
position: fixed;
top: 5px;
left: 5px;
padding: 4px 8px;
font-size: 18px;
z-index: 1000;
}

#continueBtn {
margin-top: 1rem;
padding: 0.5rem 1rem;
background: #334155;
border: none;
color: #fff;
border-radius: 6px;
cursor: pointer;
}
.choiceBtn {
margin: 0.3rem;
padding: 0.5rem 1rem;
background: #64748b;
border: none;
color: #fff;
border-radius: 6px;
cursor: pointer;
} </style>

</head>
<body>

<button id="backBtn">←</button>

<div class="wrap">
  <div class="card" id="card"></div>

  <audio id="bgm" loop preload="auto">
    <source src="./bgm.mp3" type="audio/mpeg">
  </audio>
</div>

<script>
const audio = document.getElementById('bgm');
const wrap = document.querySelector('.wrap');

let currentPage = 0;
let pageHistory = []; // 페이지 기록용 스택

// -------------------------------- 페이지 내용 --------------------------------
const pages = [
  "클릭하여 시작<br>",
  '"정신차리세요~"',
  '"드디어 일어나셨군요."',
  '눈을 뜨자 처음보는 여자가 나를 뚫어져라 바라보고 있었다.',
  '"몸은 괜찮으신가요?"',
  '"네"<br><br>나는 대답하며 주변을 둘러보았다.',
  '끝없이 이어지는 노란색 벽과, 삐걱거리는 형광등 불빛만이 허공에 떠있다.',
  '눅눅하고 축축한 공기, 사방에 길고 길게 이어진 복도는 끝없이 늘어져 있다.',
  '주위는 완전히 고요했다. 공허하게 울리는 내 목소리는 마치 세상과 단절된 것처럼 느껴진다.',
  '"저도 눈을 떠보니 이런 알 수 없는 공간에 있었어요."',
  '"아, 제 이름은 일레이나에요."',
  '그녀는 자신을 일레이나라고 소개했다.<br><br>"저는.."',
  '나는.. 누구지?',
  '내 머릿속은 텅텅 빈 듯 아무것도 기억나지 않았다.',
  '일레이나씨는 말을 하다 마는 나를 보고 걱정 하는 듯 보인다.',
  '"어디 안좋으세요..?"',
  '"놀랍게도 저에대해서 기억이 나지 않아요."',
  '"기억상실 인가요? <br>이 공간에 올때 머리를 부딪치셨을 지도 모르겠어요."',
  '"...... ."',
  '"저도 똑같은 것 같아요."',
  '"제가 어쩌다가 이곳에 왔는지, 뭘 하던 사람인지, 아무것도 모르겠어요."',
  '"저는 그래도 제 이름은 기억하네요."',
  '일레이나씨도 기억이 혼란스러운 모양이다.'
];

// 9999 페이지 추가
pages[9999] = "여기가 9999 페이지의 문장입니다.";

// ------------------------------- 페이지 이미지 -------------------------------
const pageImages = {
  0: "./Dream Time.jpg",
  2: "./기본.jpg",
  4: "./기본.jpg",
  6: "./백룸.jpg",
  7: "./백룸.jpg",
  8: "./백룸.jpg",
  9: "./시크.jpg",
  10: "./기본.jpg",
  15: "./기본.jpg",
  17: "./기본.jpg",
  18: "./시크.jpg",
  19: "./걱정.jpg",
  20: "./기본.jpg",
  21: "./기본.jpg",
};

// ------------------------------- 이미지 스타일 -------------------------------
const pageImageStyles = {};
for (let i in pageImages) pageImageStyles[i] = "width:250px; margin-top:-100px;";
pageImageStyles[0] = "width:350px; margin-top:10px;";
pageImageStyles[1] = "width:250px; margin-top:0px; transform:translateX(-240px);";

// ------------------------------- 텍스트 스타일 -------------------------------
const pageTextStyles = {};
for (let i = 0; i < pages.length; i++) pageTextStyles[i] = "margin-top:50px;";
pageTextStyles[0] = "margin-top:1rem;";
pageTextStyles[1] = "margin-top:0px;";

// ------------------------------- 코드 입력 페이지 -------------------------------
const pageCodes = {
  25: "1234"
};

// ------------------------------- BGM -------------------------------
const pageBGMs = {
  0: "./노래.mp3"
};

// ------------------------------- 선택지 정지 페이지 -------------------------------
const stopPages = [9999, 10000, 10001, 10002];

// ------------------------------- 페이지 이동 함수 -------------------------------
function goToPage(pageNum) {
  pageHistory.push(currentPage); // 이전 페이지 기록
  currentPage = pageNum;
  showPage();
}

// ------------------------------- 페이지 출력 -------------------------------
function showPage() {
  const card = document.getElementById('card');
  const backBtn = document.getElementById("backBtn");
  const saved = localStorage.getItem("currentPage");

  backBtn.style.display = currentPage === 0 ? "none" : "block";

  // 첫 페이지
  if (currentPage === 0) {
    card.innerHTML = `
      <img src="./Dream Time.jpg" style="width:350px; margin-top:10px;">
      <p style="margin-top:1rem;">클릭하여 시작<br></p>
      ${saved && saved > 0 ? `<button id="continueBtn">이어하기</button>` : ""}
    `;
    if (saved && saved > 0) {
      document.getElementById("continueBtn").addEventListener("click", (e) => {
        e.stopPropagation();
        currentPage = parseInt(saved);
        showPage();
      });
    }
    return;
  }

  if (!pages[currentPage]) {
    card.innerHTML = "마지막 페이지입니다.";
    return;
  }

  // 선택지 페이지 예시 (8페이지)
  if (currentPage === 8) {
    card.innerHTML = `
      ${pageImages[currentPage] ? `<img src="${pageImages[currentPage]}" style="${pageImageStyles[currentPage]}">` : ""}
      <p style="${pageTextStyles[currentPage]}">${pages[currentPage]}</p>
      <button class="choiceBtn" data-page="9999">1. A페이지</button>
      <button class="choiceBtn" data-page="10">2. B페이지</button>
      <button class="choiceBtn" data-page="15">3. C페이지</button>
      <button class="choiceBtn" data-page="20">4. D페이지</button>
    `;
    document.querySelectorAll('.choiceBtn').forEach(btn => {
      btn.addEventListener('click', (e) => {
        e.stopPropagation();
        goToPage(parseInt(btn.dataset.page));
      });
    });
    return;
  }

  // BGM
  if (pageBGMs[currentPage]) {
    audio.pause();
    audio.src = pageBGMs[currentPage];
    audio.play().catch(() => {});
  }

  // 코드 입력 페이지
  if (pageCodes[currentPage]) {
    card.innerHTML = `
      ${pageImages[currentPage] ? `<img src="${pageImages[currentPage]}" style="${pageImageStyles[currentPage]}">` : ""}
      <p style="${pageTextStyles[currentPage]}">${pages[currentPage]}</p>
      <input type="text" id="codeInput" placeholder="코드입력"><br>
      <button id="submitBtn">확인</button>
      <p id="msg" style="margin-top:0.5rem;opacity:0.8;"></p>
    `;
    document.getElementById('submitBtn').addEventListener('click', (e) => {
      e.stopPropagation();
      const entered = document.getElementById('codeInput').value.trim();
      const msg = document.getElementById('msg');
      if (entered === pageCodes[currentPage]) {
        goToPage(currentPage + 1);
      } else {
        msg.textContent = "코드가 틀렸습니다!";
      }
    });
    return;
  }

  // 일반 페이지
  card.innerHTML = `
    ${pageImages[currentPage] ? `<img src="${pageImages[currentPage]}" style="${pageImageStyles[currentPage]}">` : ""}
    <p style="${pageTextStyles[currentPage]}">${pages[currentPage]}</p>
  `;
}

// ------------------------------- 배경 클릭 → 다음 페이지 -------------------------------
wrap.addEventListener('click', () => {
  if (stopPages.includes(currentPage)) return;
  if (pageCodes[currentPage]) return;

  if (currentPage === 0) {
    audio.play().catch(() => {});
    goToPage(currentPage + 1);
    return;
  }

  if (currentPage < pages.length - 1) {
    goToPage(currentPage + 1);
  }
});

// ------------------------------- ← 버튼 → 이전 페이지 -------------------------------
document.getElementById("backBtn").addEventListener("click", () => {
  if (pageHistory.length > 0) {
    currentPage = pageHistory.pop(); // 마지막 페이지로 돌아감
    showPage();
  }
});

// ------------------------------- 키보드 ← -------------------------------
document.addEventListener("keydown", (e) => {
  if (e.key === "ArrowLeft" && pageHistory.length > 0) {
    currentPage = pageHistory.pop();
    showPage();
  }
});

// 처음 실행
showPage();
</script>

</body>
</html>








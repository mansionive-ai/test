<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>이야기 페이지</title>
<style>
  html, body {
    height: 100%;
    margin: 0;
    font-family: system-ui, -apple-system, Roboto, 'Noto Sans KR', sans-serif;
    background: linear-gradient(120deg,#0f172a,#0b1220);
    color: #fff;
  }
  .wrap {
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-direction: column;
    text-align: center;
    padding: 2rem;
  }
  .card {
    background: none;
    backdrop-filter: none;
    padding: 0;
    box-shadow: none;
  }
  audio { display: none; }

  /* ← 버튼 스타일 */
#backBtn {
  position: fixed;
  top: 5px;        /* 상단 끝으로 붙임 */
  left: 5px;       /* 좌측 끝으로 붙임 */
  padding: 4px 8px;
  font-size: 18px;
  z-index: 1000;
}


  #continueBtn {
    margin-top: 1rem;
    padding: 0.5rem 1rem;
    background: #334155;
    border: none;
    color: #fff;
    border-radius: 6px;
    cursor: pointer;
  }
</style>
</head>
<body>

<!-- ← 뒤로가기 버튼 -->
<button id="backBtn">←</button>

<div class="wrap">
  <div class="card" id="card"></div>

  <audio id="bgm" loop preload="auto">
    <source src="./bgm.mp3" type="audio/mpeg">
  </audio>
</div>

<script>
const audio = document.getElementById('bgm');
const wrap = document.querySelector('.wrap');

// 항상 0페이지(첫 페이지)에서 시작
let currentPage = 0;

// ------------------- 페이지 문구 -------------------
const pages = [
  "클릭하여 시작<br>",
  '"정신차리세요~"',
  '"드디어 일어나셨군요."',
'눈을 뜨자 처음보는 여자가 나를 뚫어져라 바라보고 있었다.',
'"몸은 괜찮으신가요?"',
'나는 그녀의 질문에 네라고 답하며 주변을 둘러보았다.',
'끝없이 이어지는 노란색 벽과, 삐걱거리는 형광등 불빛만이 허공에 떠있다.',
'눅눅하고 축축한 공기, 사방에 길고 길게 이어진 복도는 끝없이 늘어져 있다.',
'주위는 완전히 고요했다. 공허하게 울리는 내 목소리는 마치 세상과 단절된 것처럼 느껴진다.',
  '"저도 눈을 떠보니 이런 알 수 없는 공간에 있었어요."',
  '"아, 제 이름은 일레이나에요."',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
''
];

// ------------------- 이미지 -------------------
const pageImages = {
  0: "./Dream Time.jpg",
  2: "./기본.jpg",
  4: "./기본.jpg" ,
9: "./기본.jpg",
10: "./기본.jpg"
};

// ------------------- 이미지 스타일 -------------------
const pageImageStyles = {
  0: "width:350px; margin-top:10px;",
  1: "width:250px; margin-top:0px; transform:translateX(-240px);",
  2: "width:250px; margin-top:-100px;",
  3:  "width:250px; margin-top:-100px;",
  4:  "width:250px; margin-top:-100px;",
  5:  "width:250px; margin-top:-100px;",
 9:  "width:250px; margin-top:-100px;",
 10:  "width:250px; margin-top:-100px;"
};

// ------------------- 문장 스타일 -------------------
const pageTextStyles = {
  0: "margin-top:1rem;",
  1: "margin-top:0px;",
  2: "margin-top:50px;",
  3: "margin-top:0px;",
  4: "margin-top:50px;",
  5: "margin-top:0px;",
  6: "margin-top:0px;",
  7: "margin-top:0px;",
8: "margin-top:0px;",
9: "margin-top:50px;",
10: "margin-top:50px;",
11: "margin-top:50px;",
12: "margin-top:50px;"
};

// ------------------- 코드 입력 페이지 -------------------
const pageCodes = {
  25: "1234"
};

// ------------------- BGM -------------------
const pageBGMs = {
  0: "./노래.mp3"
  
};

function showPage() {
  const card = document.getElementById('card');
  const backBtn = document.getElementById("backBtn");
  const saved = localStorage.getItem("currentPage");

  // ← 버튼 표시 여부
  if (currentPage === 0) {
    backBtn.style.display = "none";
  } else {
    backBtn.style.display = "block";
  }

  // 첫 페이지 + 이어하기 버튼 표시
  if (currentPage === 0) {
    card.innerHTML = `
      <img src="./Dream Time.jpg" style="width:350px; margin-top:10px;">
      <p style="margin-top:1rem;">클릭하여 시작<br></p>
      ${saved && saved > 0 ? `<button id="continueBtn">이어하기</button>` : ""}
    `;

    if (saved && saved > 0) {
      document.getElementById("continueBtn").addEventListener("click", (e) => {
        e.stopPropagation(); // wrap 클릭 이벤트 방지
        currentPage = parseInt(saved);
        showPage();
      });
    }

    return;
  }

  if (currentPage >= pages.length) {
    card.innerHTML = "마지막 페이지입니다.";
    return;
  }



  // BGM 변경
  if (pageBGMs[currentPage]) {
    audio.pause();
    audio.src = pageBGMs[currentPage];
    audio.play().catch(() => {});
  }

  // 코드 입력 페이지
  if (pageCodes[currentPage]) {
    card.innerHTML = `
      ${pageImages[currentPage] ? `<img src="${pageImages[currentPage]}" style="${pageImageStyles[currentPage]}">` : ""}
      <p style="${pageTextStyles[currentPage]}">${pages[currentPage]}</p>
      <input type="text" id="codeInput" placeholder="코드입력"><br>
      <button id="submitBtn">확인</button>
      <p id="msg" style="margin-top:0.5rem;opacity:0.8;"></p>
    `;

document.getElementById('submitBtn').addEventListener('click', (e) => {
  e.stopPropagation();  // ← wrap 클릭 이벤트 방지
  const entered = document.getElementById('codeInput').value.trim();
  const msg = document.getElementById('msg');
  if (entered === pageCodes[currentPage]) {
    currentPage++;
    localStorage.setItem("currentPage", currentPage);
    showPage();
  } else {
    msg.textContent = "코드가 틀렸습니다!";
  }
});


  } else {
    // 일반 페이지
    card.innerHTML = `
      ${pageImages[currentPage] ? `<img src="${pageImages[currentPage]}" style="${pageImageStyles[currentPage]}">` : ""}
      <p style="${pageTextStyles[currentPage]}">${pages[currentPage]}</p>
    `;
  }
}

// ------------------- 배경 클릭 -> 다음페이지 -------------------
wrap.addEventListener('click', () => {
  if (pageCodes[currentPage]) return;

  if (currentPage === 0) {
    audio.play().catch(() => {});
    currentPage++;
    localStorage.setItem("currentPage", currentPage);
    showPage();
    return;
  }

  if (currentPage < pages.length - 1) {
    currentPage++;
    localStorage.setItem("currentPage", currentPage);
    showPage();
  }
});

// ------------------- ← 버튼 -> 이전 페이지 -------------------
document.getElementById("backBtn").addEventListener("click", () => {
  if (currentPage > 0) {
    currentPage--;
    localStorage.setItem("currentPage", currentPage);
    showPage();
  }
});

// ------------------- 키보드 ← -------------------
document.addEventListener("keydown", (e) => {
  if (e.key === "ArrowLeft" && currentPage > 0) {
    currentPage--;
    localStorage.setItem("currentPage", currentPage);
    showPage();
  }
});

// 첫 화면 표시
showPage();
</script>
</body>
</html>





